@using CODE_QUESTS.Models
@{
    // Get current scene number (defaulting to 1)
    int currentScene = 1;
    if (ViewData["SceneNumber"] != null)
    {
        currentScene = Convert.ToInt32(ViewData["SceneNumber"]);
    }

    ViewData["Title"] = $"Cinematic - Scene {currentScene}";
    ViewData["BodyClass"] = "cinematic-bg";

    // Get the Quiz ID to pass along
    string quizId = ViewData["QuizId"]?.ToString() ?? "Beginner";

    // Determine next step
    string nextController = "Quizzes";
    string nextAction = "IntroScene";
    string nextRouteId = (currentScene + 1).ToString();
    string buttonText = "Continue";

    // Logic for the final scene
    if (currentScene >= 3)
    {
        nextAction = "PlayMultipleChoice";
        buttonText = "Start Quest";
        nextRouteId = quizId; // Pass the quiz ID to the game
    }
}

<div class="container">
    <div class="game-start-scene">

        @if (currentScene == 1)
        {
            <div class="game-bg-image scene-one-capture"></div>
            <div class="dialogue-box style-scene-one">
                <p>When Princess Arraya, guardian of the Source Code, is captured by bandits, the kingdom begins to fall apart.</p>

                <div class="action-button">
                    <a asp-controller="@nextController" asp-action="@nextAction" asp-route-scene="@nextRouteId" asp-route-quizId="@quizId">
                        @buttonText
                        <img src="~/images/arrow-right.png" alt="Next" />
                    </a>
                </div>
            </div>
        }

        else if (currentScene == 2)
        {
        <div class="game-bg-image scene-two-vow"></div>
        <div class="dialogue-box style-scene-two">
            <p>Only the brave Sir Codewell can restore order by mastering the three ancient languages of code!</p>

            <div class="action-button">
                <a asp-controller="@nextController" asp-action="@nextAction" asp-route-scene="@nextRouteId" asp-route-quizId="@quizId">
                    @buttonText
                    <img src="~/images/arrow-right.png" alt="Next" />
                </a>
            </div>
        </div>
        }

        else if (currentScene == 3)
        {
        <div class="game-bg-image scene-three-plea"></div>
        <div class="dialogue-box style-scene-three">
            <p>“Knight, fix the code to reach me… The Source Code is shattered into tiers across the realm.”</p>

            <div class="action-button">
                <a asp-controller="Quizzes" asp-action="PlayMultipleChoice" asp-route-id="@quizId">
                    Start Quest
                    <img src="~/images/arrow-right.png" alt="Start" />
                </a>
            </div>
        </div>
        }
    </div>
</div>